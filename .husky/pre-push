echo "ğŸ§ª Running tests before push (local environment)..."
npm test

if [ $? -ne 0 ]; then
  echo "âŒ Tests failed in local environment! Please fix the issues before pushing."
  echo "ğŸ’¡ Run 'npm test' locally to see the specific failures."
  exit 1
fi

echo "ğŸ§ª Running tests before push (CI environment simulation)..."
CI=true NODE_ENV=test npm test

if [ $? -ne 0 ]; then
  echo "âŒ Tests failed in CI environment! Please fix the issues before pushing."
  echo "ğŸ’¡ This simulates GitHub Actions - run 'CI=true NODE_ENV=test npm test' to debug."
  exit 1
fi

echo "âœ… All tests passed in both local and CI environments! Safe to push."
